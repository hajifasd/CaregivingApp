# 护工资源管理系统 - 项目结构图

> **文档类型**: 项目架构可视化  
> **创建时间**: 2024年12月  
> **适用对象**: 开发团队、新成员、技术评审

---

## 🏗️ 项目整体架构图

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                               护工资源管理系统                                    │
│                              CaregivingApp                                      │
└─────────────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────────────────┐
│                                项目根目录                                        │
│                              D:\CaregivingApp                                  │
└─────────────────────────────────────────────────────────────────────────────────┘
                                    │
                    ┌───────────────┼───────────────┐
                    │               │               │
                    ▼               ▼               ▼
        ┌─────────────────┐ ┌─────────────┐ ┌─────────────┐
        │   前端页面层     │ │   后端服务层  │ │   数据存储层  │
        │   (Web Layer)   │ │ (Backend)   │ │ (Database)  │
        └─────────────────┘ └─────────────┘ └─────────────┘
```

---

## 🌐 前端页面层架构

```
web/ (前端页面目录)
├── 📄 index.html              # 🏠 首页 - 统一登录入口
├── 📄 user-register.html      # 👤 用户注册页面
├── 📄 user-dashboard.html     # 📊 用户仪表板
├── 📄 caregiver-register.html # 👨‍⚕️ 护工注册页面
├── 📄 admin-login.html        # 🔐 管理员登录页面
├── 📄 admin-dashboard.html    # 🎛️ 管理员仪表板
├── 📄 admin-users.html        # 👥 用户管理页面
├── 📄 admin-caregivers.html   # 👨‍⚕️ 护工管理页面
├── 📄 admin-job-analysis.html # 📈 工作分析页面
├── 📁 uploads/                # 📁 文件上传目录
├── 📄 style.css               # 🎨 全局样式文件
└── 📄 script.js               # ⚡ 通用脚本文件
```

**前端架构特点：**
- 🎯 **单页面应用**: 每个功能模块独立页面
- 📱 **响应式设计**: 支持移动端和桌面端
- 🔗 **统一入口**: 首页提供角色选择登录
- 🎨 **模块化样式**: CSS按功能模块组织

---

## ⚙️ 后端服务层架构

```
back/ (后端代码目录)
├── 🚀 app.py                  # 🎯 主应用入口点
├── ⚙️ extensions.py           # 🔧 Flask扩展初始化
│
├── 📁 config/                 # ⚙️ 配置管理模块
│   ├── __init__.py
│   └── settings.py            # 🔧 应用配置参数
│
├── 📁 models/                 # 🗄️ 数据模型层
│   ├── __init__.py            # 📦 模型统一导入
│   ├── user.py                # 👤 用户数据模型
│   ├── caregiver.py           # 👨‍⚕️ 护工数据模型
│   ├── service.py             # 🏥 服务类型模型
│   └── business.py            # 💼 业务数据模型
│
├── 📁 api/                    # 🌐 API接口层
│   ├── __init__.py
│   ├── auth.py                # 🔐 认证相关API
│   └── admin.py               # 👑 管理员相关API
│
├── 📁 services/               # 🧠 业务逻辑层
│   ├── __init__.py
│   └── user_service.py        # 👤 用户业务服务
│
├── 📁 utils/                  # 🛠️ 工具函数层
│   ├── __init__.py
│   ├── auth.py                # 🔐 认证工具函数
│   └── file_upload.py         # 📁 文件上传工具
│
└── 📁 web/                    # 🌐 静态文件(临时)
```

**后端架构特点：**
- 🏗️ **分层架构**: 清晰的职责分离
- 🔌 **模块化设计**: 按功能模块组织代码
- 🚀 **Flask框架**: 轻量级、灵活的Web框架
- 🗄️ **SQLAlchemy**: 强大的ORM支持

---

## 🗄️ 数据存储层架构

```
database/ (数据库相关)
├── 📄 database.py             # 🗄️ 数据库初始化脚本
└── 📄 caregiving.db           # 💾 SQLite数据库文件
```

**数据库架构特点：**
- 🗄️ **SQLite**: 轻量级、无需配置的数据库
- 🔄 **自动迁移**: 使用Flask-SQLAlchemy自动创建表
- 📊 **关系设计**: 规范化的数据库表结构
- 🔒 **数据安全**: 密码加密存储、权限控制

---

## 🔄 数据流向图

```
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   用户操作   │───►│  前端页面    │───►│  API接口    │───►│  业务服务    │
│  (Browser)  │    │ (HTML/JS)  │    │ (Flask)    │    │ (Services)  │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
                                                              │
                                                              ▼
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   响应结果   │◄───│  数据模型    │◄───│  数据库操作  │◄───│  数据访问层  │
│ (JSON/HTML) │    │ (Models)    │    │ (SQLite)   │    │ (ORM)      │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
```

---

## 🔐 认证授权架构

```
用户登录流程:
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   用户输入   │───►│  前端验证    │───►│  API验证    │───►│  生成JWT    │
│ 账号密码    │    │ 格式检查    │    │ 数据库验证  │    │ 令牌返回    │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘

权限控制流程:
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   请求携带   │───►│  验证JWT    │───►│  检查权限    │───►│  执行操作    │
│ JWT令牌     │    │ 令牌有效性  │    │ 角色权限    │    │ 或拒绝访问  │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
```

---

## 📊 数据库表关系图

```
┌─────────────┐         ┌─────────────┐         ┌─────────────┐
│    user     │         │  caregiver  │         │service_type │
│   (用户表)   │         │   (护工表)   │         │ (服务类型表) │
├─────────────┤         ├─────────────┤         ├─────────────┤
│ id (PK)     │         │ id (PK)     │         │ id (PK)     │
│ email       │         │ name        │         │ name        │
│ password    │         │ phone       │         │ description │
│ name        │         │ id_file     │         └─────────────┘
│ phone       │         │ cert_file   │                 │
│ is_approved │         │ password    │                 │
└─────────────┘         │ is_approved │                 │
         │              └─────────────┘                 │
         │                       │                      │
         │                       │                      │
         ▼                       ▼                      ▼
┌─────────────┐         ┌─────────────┐         ┌─────────────┐
│appointment  │         │ employment  │         │caregiver_   │
│ (预约表)     │         │ (雇佣表)     │         │ service     │
├─────────────┤         ├─────────────┤         │ (护工服务)   │
│ id (PK)     │         │ id (PK)     │         ├─────────────┤
│ user_id (FK)│◄────────┤ user_id (FK)│         │caregiver_id │
│ caregiver_id│◄────────┤ caregiver_id│◄────────┤ service_id  │
│ service_type│         │ service_type│         └─────────────┘
│ date        │         │ start_date  │
│ status      │         │ status      │
└─────────────┘         └─────────────┘
```

---

## 🚀 部署架构图

```
开发环境:
┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   开发者    │───►│  Flask开发   │───►│  SQLite     │
│   (本地)    │    │   服务器     │    │  数据库     │
└─────────────┘    └─────────────┘    └─────────────┘

生产环境:
┌─────────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   用户      │───►│   Nginx     │───►│  Waitress   │───►│  SQLite     │
│  (浏览器)   │    │  (反向代理)  │    │  (WSGI)     │    │  数据库     │
└─────────────┘    └─────────────┘    └─────────────┘    └─────────────┘
```

---

## 🔧 技术栈依赖关系

```
应用层依赖:
Flask App
├── Flask (Web框架)
├── Flask-SQLAlchemy (ORM)
├── PyJWT (JWT认证)
├── bcrypt (密码加密)
└── waitress (WSGI服务器)

数据层依赖:
SQLAlchemy
└── SQLite (数据库引擎)

安全层依赖:
JWT + bcrypt
├── PyJWT (令牌生成/验证)
└── bcrypt (密码哈希)
```

---

## 📁 文件组织原则

### 1. **按功能模块分组**
- `api/` - 所有API接口
- `models/` - 所有数据模型
- `services/` - 所有业务服务
- `utils/` - 所有工具函数

### 2. **按层次结构组织**
- 配置层 (`config/`)
- 接口层 (`api/`)
- 服务层 (`services/`)
- 模型层 (`models/`)
- 工具层 (`utils/`)

### 3. **命名规范**
- Python文件: `snake_case.py`
- HTML文件: `kebab-case.html`
- 目录名: `snake_case/`

---

## 🎯 架构优势

### ✅ **优点**
1. **模块化设计**: 代码结构清晰，易于维护
2. **职责分离**: 每层都有明确的职责
3. **可扩展性**: 新功能可以独立添加
4. **可测试性**: 各模块可以独立测试
5. **团队协作**: 不同开发者可以并行开发

### ⚠️ **注意事项**
1. **导入路径**: 需要正确配置Python路径
2. **模块依赖**: 避免循环导入
3. **配置管理**: 环境变量和配置文件分离
4. **错误处理**: 统一的异常处理机制

---

## 🔮 未来扩展方向

### 1. **微服务化**
- 将不同功能模块拆分为独立服务
- 使用消息队列进行服务间通信
- 支持独立部署和扩展

### 2. **容器化部署**
- 使用Docker容器化应用
- 支持Kubernetes集群部署
- 实现自动化部署和回滚

### 3. **数据库升级**
- 从SQLite迁移到PostgreSQL/MySQL
- 支持读写分离和分库分表
- 实现数据库集群和高可用

---

*本文档展示了护工资源管理系统的完整架构设计，帮助团队成员理解项目的整体结构和各模块之间的关系。* 