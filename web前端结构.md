# Web前端结构说明文档

## 📁 项目概述

本项目是一个护工服务平台的Web前端应用，采用模块化设计，将不同用户角色的功能分别组织在独立的目录中，便于维护和扩展。

## 🏗️ 目录结构

```
web/
├── index.html              # 主入口页面
├── script.js               # 公共脚本文件
├── style.css               # 公共样式文件
├── admin/                  # 管理端模块
├── user/                   # 用户端模块
├── caregiver/              # 护工端模块
├── components/             # 通用组件库
├── js/                     # JavaScript模块
├── css/                    # 样式文件
└── uploads/                # 文件上传目录
```

## 🔧 管理端 (admin/)

管理端为平台管理员提供系统管理和监控功能。

### 核心页面
- **admin-dashboard.html** - 管理仪表板
  - 系统概览数据
  - 关键指标统计
  - 快速操作入口
  
- **admin-login.html** - 管理员登录
  - 身份验证
  - 权限控制
  
- **admin-users.html** - 用户管理
  - 用户信息查看
  - 用户状态管理
  - 用户数据统计
  
- **admin-caregivers.html** - 护工管理
  - 护工信息管理
  - 资质审核
  - 工作状态监控
  
- **admin-job-analysis.html** - 工作分析
  - 服务数据分析
  - 业务趋势图表
  - 绩效评估

### 组件 (admin/components/)
- `header.html` - 管理端头部导航
- `navigation.html` - 侧边栏导航菜单
- `stats-card.html` - 数据统计卡片

## 👤 用户端 (user/)

用户端为服务需求方提供护工预约、管理和沟通功能。

### 核心页面
- **user-home.html** - 用户主页
  - 服务介绍
  - 快速预约入口
  - 推荐护工展示
  
- **user-dashboard.html** - 用户仪表板
  - 个人服务概览
  - 当前预约状态
  - 历史服务记录
  
- **user-register.html** - 用户注册
  - 账户创建
  - 个人信息填写
  - 服务需求设置
  
- **user-caregivers.html** - 护工列表
  - 护工搜索筛选
  - 护工详细信息
  - 评价和评分
  
- **user-appointments.html** - 预约管理
  - 预约创建
  - 预约状态跟踪
  - 预约修改取消
  
- **user-employments.html** - 雇佣管理
  - 雇佣合同管理
  - 服务记录
  - 费用结算
  
- **user-messages.html** - 消息管理
  - 与护工沟通
  - 系统通知
  - 消息历史
  
- **user-profile.html** - 用户资料
  - 个人信息管理
  - 服务偏好设置
  - 账户安全

### 组件 (user/components/)
- `header.html` - 用户端头部导航
- `navigation.html` - 用户导航菜单
- `stats-card.html` - 用户数据卡片

## 🏥 护工端 (caregiver/)

护工端为服务提供方提供工作管理、客户沟通和收入统计功能。

### 核心页面
- **caregiver-dashboard.html** - 护工仪表板
  - 工作概览
  - 当前任务状态
  - 收入统计
  
- **caregiver-register.html** - 护工注册
  - 个人信息填写
  - 资质认证
  - 服务范围设置

### 组件 (caregiver/components/)
- `header.html` - 护工端头部导航
- `navigation.html` - 护工导航菜单
- `stats-card.html` - 护工数据卡片

## 🧩 通用组件 (components/)

所有端共享的基础组件库，提供一致的用户体验。

### 组件列表
- **header.html** - 通用头部组件
  - 品牌标识
  - 用户状态显示
  - 全局导航
  
- **navigation.html** - 通用导航组件
  - 菜单结构
  - 权限控制
  - 响应式设计
  
- **stats-card.html** - 数据统计卡片
  - 数据展示
  - 图表渲染
  - 交互功能

## 📜 公共资源

### JavaScript模块 (js/)
- **common.js** - 公共工具函数
- **pageBuilder.js** - 页面构建器
- **chat-manager.js** - 聊天管理器（核心通信模块）
- **modules/** - 功能模块
  - `auth.js` - 认证模块
  - `navigation.js` - 导航模块
  - `ui.js` - 用户界面模块

#### chat-manager.js 详细说明

**聊天管理器**是系统的核心通信模块，实现了用户与护工之间的实时聊天功能。

##### 🚀 核心功能
- **实时通信**: 基于Socket.IO的WebSocket连接，支持实时消息收发
- **多窗口管理**: 支持同时打开多个聊天窗口，每个护工独立对话
- **消息历史**: 自动保存和加载聊天记录，支持历史消息查看
- **在线状态**: 实时显示护工在线/离线状态
- **消息搜索**: 支持关键词搜索历史消息内容

##### 🛠️ 技术特性
- **Socket.IO集成**: 自动重连、连接状态监控
- **响应式UI**: 支持窗口最小化、最大化、关闭等操作
- **消息类型**: 支持文本消息，预留图片、文件等扩展接口
- **自动滚动**: 新消息自动滚动到底部
- **输入优化**: 文本框自动调整高度，支持Enter发送

##### 📱 用户界面
- **聊天窗口**: 现代化设计，支持拖拽和调整大小
- **消息气泡**: 区分发送和接收消息，显示时间戳
- **护工信息**: 显示头像、姓名和在线状态
- **操作按钮**: 表情选择、发送、最小化、关闭等

##### 🔧 高级功能
- **新建对话**: 支持选择护工开始新聊天
- **消息搜索**: 全局搜索历史消息内容
- **通知系统**: 新消息提醒和系统通知
- **连接监控**: 实时显示服务器连接状态

##### 📊 数据管理
- **本地缓存**: 消息历史本地存储，提升用户体验
- **API集成**: 与后端聊天API无缝集成
- **错误处理**: 完善的错误处理和用户提示
- **性能优化**: 消息数量限制，避免内存溢出

### 样式文件 (css/)
- **style.css** - 全局样式
- **components.css** - 组件样式

## 🎯 架构特点

### 1. 模块化设计
- 按用户角色分离功能模块
- 每个端独立维护和扩展
- 共享组件避免代码重复

### 2. 响应式布局
- 支持多种设备尺寸
- 移动端友好的用户界面
- 渐进式增强

### 3. 组件化开发
- 可复用的UI组件
- 统一的组件接口
- 便于维护和测试

### 4. 权限管理
- 基于角色的访问控制
- 前端权限验证
- 安全的用户认证

### 5. 实时通信
- WebSocket技术实现实时聊天
- 支持多用户并发对话
- 完善的连接状态管理

## 🚀 开发指南

### 添加新功能
1. 确定功能所属的用户端
2. 在对应目录下创建新页面
3. 如需新组件，在对应components目录下创建
4. 更新导航和路由配置

### 修改现有功能
1. 定位到对应的文件位置
2. 修改功能逻辑或界面
3. 确保不影响其他端的相关功能
4. 测试功能完整性

### 组件开发
1. 遵循现有的组件结构
2. 保持组件的可复用性
3. 添加必要的文档说明
4. 确保跨端兼容性

### 聊天功能开发
1. 使用ChatManager类管理聊天状态
2. 遵循Socket.IO事件规范
3. 实现消息的本地缓存和同步
4. 注意跨窗口消息同步

## 📝 注意事项

1. **文件命名规范**：使用kebab-case命名法
2. **目录结构**：保持清晰的层次结构
3. **组件复用**：优先使用现有组件，避免重复开发
4. **样式统一**：遵循设计规范，保持界面一致性
5. **性能优化**：合理使用资源，优化加载速度
6. **实时通信**：注意WebSocket连接的生命周期管理
7. **消息安全**：验证消息发送者身份，防止消息伪造

## 🔄 版本更新

- 记录每次更新的内容
- 保持文档与代码同步
- 及时更新架构说明
- 记录重要的技术决策

---

*最后更新：2024年9月3日*
*维护人员：开发团队*
